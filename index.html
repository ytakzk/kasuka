<!doctype html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<link rel="shortcut icon" href="favicon.ico" />
	<link rel="stylesheet" href="css/style.css">
	<script type="text/javascript">
	(function() {
		var host = 'http://kakureyard.com/kasuka/';
		if ((navigator.userAgent.indexOf('iPhone') > 0 && navigator.userAgent.indexOf('iPad') == -1) || navigator.userAgent.indexOf('iPod') > 0 || navigator.userAgent.indexOf('Android') > 0) {
			location.href =  host + 'sp-index.html';
		}
	}());
	</script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script type="text/javascript" src="js/index.js"></script>
	<title>粕菓</title>
</head>
<body>

	<header>
		<h1>粕菓</h1>
	</header>

	<div id="wrapper">
		<!-- サイドバー -->
		<nav id="sidebar">
			<h1><img src="images/logo.png" alt="kasukaのロゴ"></h1>
			<ul>
				<li><a href="#item1">粕菓、とは</a></li>
				<li><a href="#item2">こだわり</a></li>
				<li><a href="#item3">楽しみ方</a></li>
				<li><a href="#item4">酒粕のちから</a></li>
				<li><a href="#item5">買い物のご案内</a></li>
				<li><a href="#item6">お問い合わせ</a></li>
			</ul>
		</nav>

		
		<!-- メインコンテンツ -->
		<article id="content">
			<canvas id="canvas" width="800" height="420"></canvas>
			<!-- 粕菓とは -->
			<section class="box section active" id="item1">
				<div id="i1-c1">
					<p>粕菓、とは<br><br>お洒落な大人のちいずけいき</p>
					<img id="i1-b1" src="images/bg1-1.png" alt="">
				</div>

				<div id="i1-c2">
					<img src="images/1-0.jpg" />
					<img src="images/1-1.jpg" />
					<img src="images/1-2.jpg" />
					<img src="images/1-3.jpg" />
				</div>
			</section>

			<!-- こだわり -->
			<section class="box section" id="item2">
				<img id="i2-b1" src="images/bg2-1.png" alt="">
				<div id="i2-c1">

					<div class="shape"></div>
				</div>
				<div id="i2-c1c">
					<p class="title">酒粕</p>
					<p>老舗酒造「黄桜」で<br>つくられた豊かな<br>風味とコク</p>
				</div>				
				<img id="i2-c2" src="images/1-2.jpg" alt="">
				<div id="i2-c3">
					<p class="title">素材</p>
					<p>クリームチーズ<br>バターなど<br><br>酒粕と相性の良い素材を厳選</p>
				</div>
			</section>

			<!-- 楽しみ方 -->
			<section class="box section" id="item3">
				<div id="i3-c1">
					<p class="title">楽しみ方</p>
					<img id="i3-b1" src="images/bg3-1.png" alt="">
				</div>
				<div id="i3-c2">
					<p>冷やして食感を味わい、<br>とかしてコクを味わう楽しみ方</p>
				</div>
				<img id="i3-c3" src="images/2.jpg" alt="">
				<img id="i3-c4" src="images/3.jpg" alt="">
				<div id="i3-c5">
					<img id="i3-b2" src="images/bg3-2.png" alt="">
					<div class="triangle"></div>
					<p>三角、四角...<br>切り分けてみんなで楽しむ</p>
				</div>
				<div id="i3-c6">
					<div class="triangle"></div>
					<p>お皿にひとかけら<br>一人の時間を味わう楽しみ方</p>
					<img id="i3-b3" src="images/bg3-3.png" alt="">
				</div>
				<img id="i3-c7" src="images/4.jpg" alt="">
			</section>

			<!-- 酒粕のちから -->
			<section class="box section" id="item4">
				<div id="i4-1" class="i4box">
					<p class="title">酒粕の<br>ちから</p>
				</div>
				<div id="i4-2" class="i4box">
					<div class="shape1"></div>
					<div class="shape2"></div>
					<p>豊かな風味をうみだす</p>
					<img src="images/i4-1.png" alt="">
				</div>
				<div id="i4-3" class="i4box">
					<div class="shape1"></div>
					<div class="shape2"></div>	<p>太りにくいちから</p>
					<img src="images/i4-2.png" alt="">
				</div>
				<div id="i4-4" class="i4box">
					<div class="shape1"></div>
					<div class="shape2"></div>	<p>お腹をきれいにするちから</p>
					<img src="images/i4-3.png" alt="">
				</div>
			</section>

			<!-- お買い物のご案内 -->
			<section class="box section" id="item5">
				<img id="i5-b1" src="images/bg5-1.png" alt="">
				<div id="i5-1">
					<p class="title">お買い物のご案内</p>
					<table border="0" cellspacing="0" cellpadding="5" bordercolor="#333333">
						<tr>
							<td>01.&nbsp</td>
							<td>下のボタンから申し込みをしてください。</td>
						</tr>
						<tr>
							<td>02.&nbsp</td>
							<td>払い込みは、コンビニ振込み / クレジットカード / 代引きから選べます。</td>
						</tr>
						<tr>
							<td>03.&nbsp</td>
							<td>宅配便にてご自宅に送付します。</td>
						</tr>
					</table>
				</div>
				<div id="i5-2">
					<a href="purchase.html">注文する</a>
				</div>
			</section>
		</article>

	</div>
	<footer>
		<div id="i6-1">
			<h1>お問い合わせ</h1>
			<ul>
				<li>kakureyado.</li>
				<li>t/090-1234-5678</li>
				<li>m/info@kakureyard.com</li>
			</ul>

			<img id="i6-b1" src="images/bg6-1.png" alt="">
			<img id="i6-b2" src="images/bg6-2.png" alt="">
		</div>
	</footer>

</body>
</html>

<script type="text/javascript">
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');
var textAlpha = 0.0;
var timeTriger = new Array(10, 130, 120, 140, 200);
var offsetX = 20;
var offsetY = 20;
var ratio = 1.0;
var time = 0;
var figures;

var Point = function(x, y, r) {
	this.x = x*ratio;
	this.y = y*ratio;
	if (arguments.length == 3) {this.radius = r*ratio; }
}

var Figure = function(pts, mode) {
	this.pts = pts;
	this.mode = mode;
	switch (mode) {
		case 0 : this.offset = new Point(0, 0); this.alpha = 1; break; //背景
		case 1 : this.offset = new Point(offsetX, offsetY); this.alpha = 1; break; //普通
		case 2 : this.offset = new Point(offsetX, offsetY); this.alpha = 1; break; //色あせていく
		case 3 : this.offset = new Point(offsetX, offsetY); this.alpha = 0; break; //青色に変わる
	}
}

Figure.prototype = {
	update: function() {
		if (this.mode == 0 && this.alpha >= 0.02 && time > timeTriger[0]) {
			this.alpha = Math.round((this.alpha - 0.02) * 100) /100;
		} else if (this.mode == 2 && this.alpha >= 0.02 && time > timeTriger[1]) {
			this.alpha-=0.02;
		} else if (this.mode == 3 && this.alpha < .5 && time > timeTriger[2]) {
			this.alpha+=0.015;
		}  

	},
	draw: function() {
		pts = this.pts;
		offset = this.offset;
		ctx.beginPath();
		ctx.moveTo(pts[0].x + offset.x, pts[0].y + offset.y);

		for (var i = 1; i < pts.length; i++) {
			pt = pts[i];
			if (pt.radius !== undefined) {
				nextPt = pts[i+1];
				ctx.arcTo(pt.x + offset.x, pt.y + offset.y, nextPt.x + offset.x, nextPt.y + offset.y, pt.radius);
				i++;
			} else {
				ctx.lineTo(pt.x + offset.x, pt.y + offset.y);
			}

		}
		ctx.closePath();

		if (this.mode != 3) {
			ctx.fillStyle = 'rgba(255, 242, 51,' + this.alpha + ')';
		} else {
			ctx.fillStyle = 'rgba(107, 181, 237,' + this.alpha + ')';
		}
		ctx.fill();
	}
}

function setup(){
	figures = [];
	figures.push(new Figure([new Point(0, 0), new Point(0, canvas.height), new Point(canvas.width, canvas.height), new Point(canvas.width, 0)], 0));
	figures.push(new Figure([new Point(0, 20), new Point(40, 60), new Point(40, 20)], 2));
	figures.push(new Figure([new Point(0, 20), new Point(40, 60), new Point(40, 20)], 3));
	figures.push(new Figure([new Point(0, 60), new Point(0, 110), new Point(75, 110), new Point(75, 60)], 1));
	figures.push(new Figure([new Point(40, 125), new Point(40, 200, 40), new Point(0, 200), new Point(0, 125)], 2));
	figures.push(new Figure([new Point(40, 125), new Point(40, 200, 40), new Point(0, 200), new Point(0, 125)], 3));
	figures.push(new Figure([new Point(40, 195), new Point(40, 270), new Point(80, 270)], 1));
	figures.push(new Figure([new Point(50, 0), new Point(50, 40), new Point(90, 0)], 1));
	figures.push(new Figure([new Point(90, 90), new Point(90, 240), new Point(165, 240), new Point(165, 90)], 2));
	figures.push(new Figure([new Point(90, 90), new Point(90, 240), new Point(165, 240), new Point(165, 90)], 3));
	figures.push(new Figure([new Point(180, 120), new Point(180, 170), new Point(205, 170), new Point(205, 120)], 2));
	figures.push(new Figure([new Point(180, 120), new Point(180, 170), new Point(205, 170), new Point(205, 120)], 3));
	figures.push(new Figure([new Point(220, 260), new Point(220, 360, 40), new Point(180, 360), new Point(180, 260)], 1));
	figures.push(new Figure([new Point(205, 170), new Point(205, 240), new Point(275, 240), new Point(275, 170)], 1));
	figures.push(new Figure([new Point(255, 200), new Point(255, 270), new Point(345, 270), new Point(345, 200)], 2));
	figures.push(new Figure([new Point(255, 200), new Point(255, 270), new Point(345, 270), new Point(345, 200)], 3));
	figures.push(new Figure([new Point(275, 120), new Point(275, 170), new Point(320, 170), new Point(320, 120)], 2));
	figures.push(new Figure([new Point(275, 120), new Point(275, 170), new Point(320, 170), new Point(320, 120)], 3));
	figures.push(new Figure([new Point(290, 285), new Point(333, 360), new Point(360, 360), new Point(317, 285)], 1));

	if (canvas.getContext){ setInterval(redraw, 30); }
};

onload = function() {
	setup();
};

function redraw() {
	update();
	draw();
};

function update() {
	time++;

	if (time > timeTriger[3] && textAlpha < 1.0) {
		textAlpha += 0.007;
	}

	for (var i = 0; i < figures.length; i++) {
		figures[i].update();
	}
};

function draw() {
	ctx.clearRect(0, 0, canvas.width, canvas.height);

	for (var i = 0; i < figures.length; i++) {
		figures[i].draw();
	}
	ctx.font = 'bold 30px "游明朝", YuMincho, "Hiragino Mincho ProN", Meiryo, serif'; 
	verticalwrite(ctx, "粕　　　　菓", 600, 100, textAlpha);
	ctx.font = 'bold 16px "游明朝", YuMincho, "Hiragino Mincho ProN", Meiryo, serif'; 
	verticalwrite(ctx, "大人のちいずけいき", 750, 250, textAlpha);
};

var verticalwrite = function(context, text, x, y, alpha) {
	var textList = text.split('\n');
	var lineHeight = context.measureText("あ").width;
	textList.forEach(function(elm, i) {
		Array.prototype.forEach.call(elm, function(ch, j) {
			context.fillStyle = 'rgba(150, 150, 150,' + alpha + ')';
			context.fillText(ch, x-lineHeight*i, y+lineHeight*j);
		});
	});
};
</script>